/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package presentation;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.*;

import javax.swing.*;
import javax.swing.border.Border;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;
import javax.swing.table.TableModel;
import javax.swing.text.DateFormatter;
import javax.swing.text.DefaultFormatterFactory;

import services.PersistenceService;

public class QueryInterfaceUI extends javax.swing.JFrame implements 

ActionListener, ChangeListener {

   
	
	
	static final int WIDTH = 800;
	static final int HEIGHT = 220;

	static final String ACTION_RUN = "runQuery";
	

	static final double DEFAULT_AXIAL_TILT = 23.44;
	static final double DEFAULT_ORBITAL_ECCENTRICITY = .0167;
	private Date simStart, simEnd;
	private static final long serialVersionUID = -15968456987503L; 
	private double tilt = DEFAUL_AXIAL_TILT;
	// persistence service
	private PersistenceService ps;
	private static QueryInterfaceUI instance;
	int WIDTH_LABELS = WIDTH * 4 / 7 * 1
			/ 4;
	int WIDTH_EDITS = WIDTH * 4 / 7 * 3
			/ 4;
	int LABEL_HEIGHT = 26;
	private String simulationName = null;
	private int latStart, latEnd, longStart, longEnd;
	private boolean maxTemp, minTemp, meanTempRegion, meanTempTime, tempsTimeRegion;
	
	private double eccentricity = DEFAULT_ORBITAL_ECCENTRICITY;
	


	
	 /**
     * Creates new form QueryInterfaceUI
     */
   private QueryInterfaceUI() {
        
    	//ps = PersistenceService.getInstance();
    	createGui();
    	this.setVisible(true);
    	setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Query Interface");
        setName("QInterfaceFrame"); 
        
    }
    
  //Singleton, similar to Gui.java
  	public static QueryInterfaceUI getInstance() {
  		if (instance == null) {
  			instance = new QueryInterfaceUI();
  		}
  		return instance;
  	}

  	public static void destroy() {
		if (instance != null) {
			instance = null;
		}
	}

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
   // @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-

BEGIN:initComponents
    private void createGui() {
    	
    	
    	this.getContentPane().setPreferredSize(
				new Dimension(800, 620));
    	int EDIT_BOX_WIDTH = 4;
		int LABEL_HEIGHT = 26;
    	/*JPanel mainPanel;
		mainPanel = new JPanel();
		Panel.setBorder(BorderFactory.createMatteBorder(0, 1, 0, 1,
				Color.blue));
		Panel.setLayout(new java.awt.BorderLayout());*/
		Panel.add(createPanel(), BorderLayout.CENTER);
		*/
		
		QueryInterfaceLabel = new javax.swing.JLabel();
        tableOptionsLabel = new javax.swing.JLabel();
        qrybuttonGroup1 = new ButtonGroup();
        regionbuttonGroup = new ButtonGroup();
        runQuery = new javax.swing.JButton();
        reset = new javax.swing.JButton();
        filter = new javax.swing.JButton();
        animate = new javax.swing.JButton();
        byNameButton = new JRadioButton();
        byPFButton = new JRadioButton();
        earthButton = new JRadioButton();
        parametersButton = new JRadioButton();
        jPanel1 = new javax.swing.JPanel();
        simulationNameLabel = new javax.swing.JLabel();
        
        
        //simulationNameField = new javax.swing.JTextField(20);
        //axisTiltSlider = new javax.swing.JSlider();
        axisTiltLabel = new javax.swing.JLabel();
        axisTiltField = new javax.swing.JTextField(EDIT_BOX_WIDTH);
        orbitalEccentricityLabel = new javax.swing.JLabel();
        orbitalEccentricityField = new javax.swing.JTextField(EDIT_BOX_WIDTH);
        latitudeLabel = new javax.swing.JLabel();
        latitudeFromField = new javax.swing.JTextField(EDIT_BOX_WIDTH);
        jLabel10 = new javax.swing.JLabel();
        latitudeToField = new javax.swing.JTextField(EDIT_BOX_WIDTH);
        longitudeLabel = new javax.swing.JLabel();
        longitudeFromField = new javax.swing.JTextField(EDIT_BOX_WIDTH);
        jLabel11 = new javax.swing.JLabel();
        longitudeToField = new javax.swing.JTextField(EDIT_BOX_WIDTH);
        simulationPeriodLabel = new javax.swing.JLabel();
        simulationStartField = new javax.swing.JFormattedTextField();
        simulationStartField.setColumns(5);
        simulationStartField.setActionCommand(getName());
        
        latitudeFromField.setEnabled(false);
        latitudeToField.setEnabled(false);
        longitudeFromField.setEnabled(false);
        longitudeToField.setEnabled(false);
        
        jLabel9 = new javax.swing.JLabel();
        simulationEndField = new javax.swing.JFormattedTextField();
        simulationEndField.setColumns(5);
        //simulationEndField.setMinimumSize( new Dimension(WIDTH_EDITS,	HEIGHT));
        simulationEndField.setActionCommand(getName());
        jPanel2 = new javax.swing.JPanel();
        minTempLabel = new javax.swing.JLabel();
        minTempCheckbox = new javax.swing.JCheckBox();
        regionMeanTempLabel = new javax.swing.JLabel();
        meanTempRegionCheckbox = new javax.swing.JCheckBox();
        maxTempLabel = new javax.swing.JLabel();
        maxTempRegionCheckbox = new javax.swing.JCheckBox();
        timeMeanTempLabel = new javax.swing.JLabel();
        meanTempTimeCheckbox = new javax.swing.JCheckBox();
        tempTimeRegionLabel = new javax.swing.JLabel();
        tempsTimeRegionCheckbox = new javax.swing.JCheckBox();
        
        QueryInterfaceLabel.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        QueryInterfaceLabel.setText("Query Interface");
        
        JLabel s1 = new JLabel("                                             ");
        JLabel s2 = new JLabel("                   ");
        JLabel s3 = new JLabel("   ");

		
		JPanel topPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
		topPanel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
		
    	qrybuttonGroup1.add(byNameButton); 
        byNameButton.setText("Name");
        byNameButton.setActionCommand("byName");
        byNameButton.addActionListener(this);
        qrybuttonGroup1.add(byPFButton);
        byPFButton.setText("Physical Factors");
        byPFButton.setActionCommand("byPF");
        byPFButton.addActionListener(this);
       

        simulationNameLabel.setText("Simulation name: ");
        
        nameSpinner = new JSpinner();
        nameSpinner.setName("Name");
        nameSpinner.setSize(EDIT_BOX_WIDTH, LABEL_HEIGHT);
        nameSpinner.addChangeListener(this);
        //nameSpinner.setModel(new SimulationNameSpinnerModel(new Object[]{}));
        nameSpinner.setModel(new SpinnerListModel(new Object[]{" "}));
        JPanel namePFPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        namePFPanel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
        Border nameBorder = BorderFactory.createTitledBorder("Search by ");
        
        //namePFPanel.add(new JLabel("Search by: "));
        
        JPanel namePFRadioPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        //namePFRadioPanel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
        
        namePFRadioPanel.add(byNameButton);
        namePFRadioPanel.add(byPFButton);
        namePFRadioPanel.setBorder(nameBorder);
        
        
        namePFPanel.add(namePFRadioPanel, BorderLayout.NORTH );
        
        JPanel namePFvaluePanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        Border valueBorder = BorderFactory.createTitledBorder("Matching Simulations ");
        
        
        namePFvaluePanel.add(simulationNameLabel);
        namePFvaluePanel.add(nameSpinner);
       
     
        namePFvaluePanel.setBorder(valueBorder);
        namePFPanel.add(namePFvaluePanel, BorderLayout.CENTER );
        
        
        JPanel filterPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        filter.setText("Filter");
        filter.addActionListener(this);
		filter.setEnabled(true); 
        filter.setActionCommand("filter");
        filterPanel.add(filter);
        
        
        namePFPanel.add(filterPanel, BorderLayout.SOUTH );
        topPanel.add(namePFPanel, BorderLayout.WEST);
        
        
        JPanel options2Panel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        options2Panel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
        JPanel PFPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        //PFPanel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
        Border pfBorder = BorderFactory.createTitledBorder("Physical factors ");
        PFPanel.setBorder(pfBorder);
        /*axisTiltSlider.setMajorTickSpacing(60);
        axisTiltSlider.setMaximum(180);
        axisTiltSlider.setMinimum(-180);
        axisTiltSlider.setMinorTickSpacing(30);
        axisTiltSlider.setPaintLabels(true);
        axisTiltSlider.setPaintTicks(true);

        
        axisTiltSlider.setPreferredSize(new Dimension(15, 75));*/
        axisTiltLabel.setText("Axial tilt");
        orbitalEccentricityLabel.setText("Orbital eccentricity");
        axisTiltField.setEnabled(false);
        orbitalEccentricityField.setEnabled(false);
        PFPanel.add(axisTiltLabel);
        PFPanel.add(axisTiltField);
       // PFPanel.add(axisTiltSlider);
        PFPanel.add(orbitalEccentricityLabel);
        PFPanel.add(orbitalEccentricityField);
        
        options2Panel.add(PFPanel, BorderLayout.NORTH);
        
        
        
        JPanel periodPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        //periodPanel.setPreferredSize(new Dimension(WIDTH_EDITS, 150));
        Border periodBorder = BorderFactory.createTitledBorder("Time Period ");
        periodBorder.getBorderInsets(PFPanel);
        periodPanel.setBorder(periodBorder);
        simulationStartField.setEnabled(false);
        simulationEndField.setEnabled(false);
        //periodPanel.add(new JLabel("Simulation Time period"));
        periodPanel.add(new JLabel("Start time:"));
        periodPanel.add(simulationStartField);
        periodPanel.add(new JLabel("End time:"));
        periodPanel.add(simulationEndField);
        periodPanel.add(new JLabel("                               "));
        
        simulationStartField.setAction(simulationStartField.getAction());
        simulationEndField.setAction(simulationEndField.getAction());
        //PFPanel.add(periodPanel, BorderLayout.SOUTH);
        options2Panel.add(periodPanel, BorderLayout.SOUTH);
        
        topPanel.add(options2Panel, BorderLayout.EAST);
        
        this.getContentPane().add(topPanel, BorderLayout.NORTH);
        JPanel regionPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        regionPanel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
        Border regionBorder = BorderFactory.createTitledBorder("");
        regionPanel.setBorder(regionBorder);
        Border regionoptionBorder = BorderFactory.createTitledBorder("Physical 

bounds ");
        
        JPanel regionoptionPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        regionoptionPanel.setBorder(regionoptionBorder);
        //regionPanel.add(new JLabel("Physical bounds"));
        regionPanel.add(s1);
        regionbuttonGroup.add(earthButton); 
        earthButton.setText("Whole Earth");
        earthButton.setActionCommand("earth");
        earthButton.addActionListener(this);
        regionbuttonGroup.add(parametersButton);
        parametersButton.setText("Use parameters provided");
        parametersButton.setActionCommand("parameters");
        parametersButton.addActionListener(this);
       
        
        regionoptionPanel.add(earthButton);
        //regionoptionPanel.add(s3);
        regionoptionPanel.add(parametersButton);
        regionPanel.add(regionoptionPanel, BorderLayout.NORTH);
        
        JPanel locationPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        Border locBorder = BorderFactory.createTitledBorder("");
        regionPanel.setBorder(locBorder);
        latitudeFromField.setEnabled(false);
        latitudeToField.setEnabled(false);
        longitudeFromField.setEnabled(false);
        longitudeToField.setEnabled(false);
        latitudeLabel.setText("Latitude");
        locationPanel.add(latitudeLabel);
        locationPanel.add(new JLabel("Start"));
        locationPanel.add(latitudeFromField);
        locationPanel.add(new JLabel("End"));
        locationPanel.add(latitudeToField);
        locationPanel.add(s3);
        longitudeLabel.setText("Longitude");
        locationPanel.add(longitudeLabel);
        locationPanel.add(new JLabel("Start"));
        locationPanel.add(longitudeFromField);
        locationPanel.add(new JLabel("End"));
        locationPanel.add(longitudeToField);
        
        regionPanel.add(locationPanel, BorderLayout.SOUTH);
        this.getContentPane().add(regionPanel, BorderLayout.CENTER);

        
        
        JPanel optionsPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        optionsPanel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
        Border optionsBorder = BorderFactory.createTitledBorder("Include results 

for");
        optionsPanel.setBorder(optionsBorder);
        
        minTempLabel.setText("Minumum temperature in the region selected");

        regionMeanTempLabel.setText("Mean temperature for the region selected");

        maxTempLabel.setText("Maximum temperature in the region selected");

        timeMeanTempLabel.setText("Mean temperature for the requested time 

period");

        tempTimeRegionLabel.setText("Temperatures for region over time period");
        
        JPanel optionlabelsPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        optionlabelsPanel.setPreferredSize(new Dimension(WIDTH_EDITS, 150));
        JPanel optionchkboxPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        optionchkboxPanel.setPreferredSize(new Dimension(WIDTH_EDITS, 150));
        optionlabelsPanel.add(minTempLabel);
        optionlabelsPanel.add(regionMeanTempLabel);
        optionlabelsPanel.add(maxTempLabel);
        optionlabelsPanel.add(timeMeanTempLabel);
        optionlabelsPanel.add(tempTimeRegionLabel);
        
        //optionchkboxPanel.add(minTempCheckbox);
        optionchkboxPanel.add(minTempCheckbox, 0);
        optionchkboxPanel.add(s1);
        optionchkboxPanel.add(meanTempRegionCheckbox,0);
        optionchkboxPanel.add(s1);
        optionchkboxPanel.add(maxTempRegionCheckbox,0);
        optionchkboxPanel.add(s1);
        optionchkboxPanel.add(meanTempTimeCheckbox,0);
        optionchkboxPanel.add(s1);
        optionchkboxPanel.add(tempsTimeRegionCheckbox,0);

        JPanel runresetPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        runresetPanel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
        runQuery.setText("Run Query");
        runQuery.addActionListener(this);
		runQuery.setEnabled(true); 
        runQuery.setActionCommand(ACTION_RUN);
        runresetPanel.add(runQuery);
        reset.setText("Reset");
        reset.addActionListener(this);
        reset.setEnabled(true); 
        reset.setActionCommand("reset");
        animate.setText("Animate");
        animate.addActionListener(this);
		animate.setEnabled(true); 
        animate.setActionCommand("animate");
        
        
        
        runresetPanel.add(reset);
        runresetPanel.add(animate);
        
        optionsPanel.add(optionlabelsPanel, BorderLayout.WEST);
        optionsPanel.add(optionchkboxPanel, BorderLayout.EAST);
        optionsPanel.add(runresetPanel, BorderLayout.CENTER);
        this.getContentPane().add(optionsPanel, BorderLayout.SOUTH);
        
        simulationEndField.addActionListener(this);
         
        

        pack();
    }// </editor-fold>//GEN-END:initComponents

         
    
    public JPanel createOutputGui()
    {
    	
    	this.getContentPane().setPreferredSize( 
				new Dimension(800, 620));
    	int EDIT_BOX_WIDTH = 4;
		int LABEL_HEIGHT = 26;
		JLabel s1 = new JLabel("                                           

  ");
        JLabel s2 = new JLabel("                   ");
        JLabel s3 = new JLabel("   ");
    	JPanel Panel;
		Panel = new JPanel();
		//Panel.setBorder(BorderFactory.createMatteBorder(1, 1, 1, 

1,Color.blue));
		Panel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
		Panel.setLayout(new java.awt.BorderLayout());
		
		
		minTempLabel = new javax.swing.JLabel("Minimum temperature: ");
		 
		maxTempLabel = new javax.swing.JLabel("Maximum Temperature: ");
		regionMeanTempLabel = new javax.swing.JLabel("Mean Temperature in the region: ");
		timeMeanTempLabel = new javax.swing.JLabel("Mean Temperature during this period:");
		tempTimeRegionLabel = new javax.swing.JLabel("Temperature/grid cell:");
		animate = new javax.swing.JButton();
		outputTable = new JTable();
		
		System.out.println("Inside createOutputGui method");
		JPanel topPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
		topPanel.setPreferredSize(new Dimension(WIDTH_EDITS,
				HEIGHT));
		JPanel labelPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
		labelPanel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
		
		
		labelPanel.add(minTempLabel,0);
		
		labelPanel.add(s1);
		labelPanel.add(s1);
		labelPanel.add(maxTempLabel,1);
		labelPanel.add(s1);
		labelPanel.add(s1);
		labelPanel.add(regionMeanTempLabel,2);
		labelPanel.add(s1);
		labelPanel.add(s1);
		labelPanel.add(timeMeanTempLabel,3);
		labelPanel.add(s1);
		labelPanel.add(s1);
		labelPanel.add(tempTimeRegionLabel,4);
		labelPanel.add(s1);
		
		
		
		topPanel.add(labelPanel, BorderLayout.WEST);
		
		JPanel valuePanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
		valuePanel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
		
		valuePanel.add(new JLabel("23"),0);
		valuePanel.add(s1);
		valuePanel.add(new JLabel("75"),1);
		valuePanel.add(s1);
		valuePanel.add(new JLabel("45"),2);
		valuePanel.add(s1);
		valuePanel.add(new JLabel("35"),3);
		valuePanel.add(s1);
		valuePanel.add(new JLabel("54"),4);
		valuePanel.add(s1);
		
		animate.setText("Animate");
	    animate.addActionListener(this);
	    animate.setEnabled(true); 
	    animate.setActionCommand("animate");
	    
	    valuePanel.add(animate);
		topPanel.add(valuePanel, BorderLayout.EAST);
		
        Panel.add(topPanel, BorderLayout.NORTH);
		JPanel bottomPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
		bottomPanel.setPreferredSize(new Dimension(WIDTH_EDITS, HEIGHT));
		
		outputTable.setModel(new javax.swing.table.DefaultTableModel(
		            new Object [][] {
		                {4, 5, 6, 7},
		                {null, null, null, null},
		                {null, null, null, null},
		                {null, null, null, null}
		            },
		            new String [] {
		                "Title 1", "Title 2", "Title 3", "Title 4"
		            }
		        ));
		JScrollPane tableScroll = new JScrollPane(outputTable);
        Dimension tablePreferred = tableScroll.getPreferredSize();
        tableScroll.setPreferredSize(
            new Dimension(tablePreferred.width, tablePreferred.height/3) );

	 //outputTable.setModel((TableModel) new SpinnerListModel());
		       
		 bottomPanel.add(tableScroll);
		 Panel.add(bottomPanel, BorderLayout.SOUTH);
	    
	     pack();
	     
	     
	     return Panel;
    	
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code  (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the 

default look and feel.
         * For details see 

http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
       try {
            for (javax.swing.UIManager.LookAndFeelInfo info : 

javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(QueryInterfaceUI.class.getName

()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(QueryInterfaceUI.class.getName

()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(QueryInterfaceUI.class.getName

()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(QueryInterfaceUI.class.getName

()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new QueryInterfaceUI().setVisible(true);
               
                
            }
        });
    }

    
    //set simulation start and end time.
    
    public void setSimulationPeriod(String start, String end)
    {
    	 SimpleDateFormat dtf 
         = new SimpleDateFormat("dd/MMM/yyyy HH:mm:ss.SSS");
    	 try{
    		 
    		 System.out.println("Sim start: " + simulationStartField.getText

());
        	 System.out.println("Sim end: "+ simulationEndField.getText());
    	 simStart = dtf.parse(simulationStartField.getText());
    	 simEnd = dtf.parse(simulationEndField.getText());
    	 System.out.println("Sim start: " + simStart);
    	 System.out.println("Sim end: "+ simEnd);
    	 }
    	 catch(Exception e)
    	 {
    		 System.out.println("Error parsing date time");
    	 }
    }
    
    @Override
	public void actionPerformed(ActionEvent e) {
		//get the command
		String command = e.getActionCommand();
		
		if (command.equals("byName"))
		{
			//Remove 2 lines and add code to retrieve values from DB
			List<String> lst = new ArrayList<String>();
			lst.add("Nov12-2014");
			lst.add("Oct19-2014");
			
			SpinnerListModel smodel = (SpinnerListModel) nameSpinner.getModel();
			smodel.setList(lst);
			
			
			
		}
		else if(command.equals("byPF"))
		{
			axisTiltField.setEnabled(true);
	        orbitalEccentricityField.setEnabled(true);
	        simulationStartField.setEnabled(true);
	        simulationEndField.setEnabled(true);
		}
		else if(command.equals("earth"))
		{
			
		}
		else if(command.equals("parameters"))
		{
			latitudeFromField.setEnabled(true);
	        latitudeToField.setEnabled(true);
	        longitudeFromField.setEnabled(true);
	        longitudeToField.setEnabled(true);
		}
		else if (command.equals(ACTION_RUN)) {
			
			
			
			
			//disable all controls
			//this.setEnableAllUserOptions(false);
			//disable the run button
			//runQuery.setEnabled(false);
			
			//call persisitence controller here
			
	    	//this.getContentPane().validate();
	    	//this.getContentPane().repaint();
			
			JPanel newoutput = runQuery();
			//this.getContentPane().removeAll();
			this.setVisible(true);
			
			System.out.println("Before validating");
			
			//this.getContentPane().invalidate();
			System.out.println("Before repainting");
			this.getContentPane().add(newoutput, BorderLayout.EAST);
			System.out.println(newoutput.getComponentCount());
	    	//this.getContentPane().repaint();
	    	System.out.println("after repainting");
	    	this.setVisible(true);
	    	
			
			//this.setEnableAllUserOptions(false);
			
		}
		else if(command.equals("Reset"))
		{
			clear();
		}
		else if(command.equals(simulationEndField.getAction()))
		{
		 //simulationEndFieldActionPerformed(evt)
    	
			setSimulationPeriod(simulationStartField.getText(),simulationEndField.getText());
		}
		else if(command.equals("animate"))
		{
			
		}
    }
    
    public void stateChanged(ChangeEvent e) {
        SpinnerListModel sModel = nameSpinner.getModel();
        if (sModel instanceof SpinnerListModel) {
            
        }
    }

    
   
  //enable/disable all controls
  	private void setEnableAllUserOptions(boolean bEnable) {
  	
  		
  		
         runQuery.setEnabled(bEnable);
         simulationNameField.setEnabled(bEnable);
         //axisTiltSlider.setEnabled(bEnable);
         orbitalEccentricityField.setEnabled(bEnable);
         latitudeFromField.setEnabled(bEnable);
         latitudeToField.setEnabled(bEnable);
         longitudeFromField.setEnabled(bEnable);
         longitudeToField.setEnabled(bEnable);
         simulationStartField.setEnabled(bEnable);
         simulationEndField.setEnabled(bEnable);
         minTempCheckbox.setEnabled(bEnable);
         meanTempRegionCheckbox.setEnabled(bEnable);
         maxTempRegionCheckbox.setEnabled(bEnable);
         meanTempTimeCheckbox.setEnabled(bEnable);
         tempsTimeRegionCheckbox.setEnabled(bEnable);

  	}

  	
  	public void clear()
  	{
  		simulationNameField.setText(null);
        //axisTiltSlider.setValue(0);
        orbitalEccentricityField.setText(null);
        latitudeFromField.setText(null);
        latitudeToField.setText(null);
        longitudeFromField.setText(null);
        longitudeToField.setText(null);
        simulationStartField.setText(null);
        simulationEndField.setText(null);
        minTempCheckbox.setSelected(false);
        meanTempRegionCheckbox.setSelected(false);
        maxTempRegionCheckbox.setSelected(false);
        meanTempTimeCheckbox.setSelected(false);
        tempsTimeRegionCheckbox.setSelected(false);
  	}
    //call persistence controller and execute the query. Create output ui 
  	//to display results
    public JPanel runQuery()
    {
    	//for now it just prints all the values to console.
    	
    	//System.out.println("Name: "+ simulationNameField.getText());
    	//System.out.println("Axial tilt: "+ axisTiltSlider.getValue());
    	System.out.println("ecc: "+ orbitalEccentricityField.getText());
    	System.out.println("latitude: "+ latitudeFromField.getText() + " to " + 

latitudeToField.getText());
    	System.out.println("longitude: "+ longitudeFromField.getText() + " to " + 

longitudeToField.getText());
    	System.out.println("simulation: "+ simulationStartField.getText() + " to " 

+ simulationEndField.getText());
    	System.out.println("Min Temp "+ minTempCheckbox.isSelected());
    	System.out.println("Max Temp"+ maxTempRegionCheckbox.isSelected());
    	System.out.println("Regional avg temp "+ 

meanTempRegionCheckbox.isSelected());
    	System.out.println("Avg temp for the period "+ 

meanTempTimeCheckbox.isSelected() );
    	
    	//JPanel outputPanel = createOutputGui();
    	
    	return createOutputGui();
    	
    	
    }
    
    public void stateChanged(ChangeEvent e) {

	}
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel QueryInterfaceLabel;
    private javax.swing.JLabel axisTiltLabel;
    private javax.swing.JSlider axisTiltSlider;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JTextField latitudeFromField;
    private javax.swing.JTextField axisTiltField;
    private javax.swing.JLabel latitudeLabel;
    private javax.swing.JTextField latitudeToField;
    private javax.swing.JTextField longitudeFromField;
    private javax.swing.JLabel longitudeLabel;
    private javax.swing.JTextField longitudeToField;
    private javax.swing.JLabel maxTempLabel;
    private javax.swing.JCheckBox maxTempRegionCheckbox;
    private javax.swing.JCheckBox meanTempRegionCheckbox;
    private javax.swing.JCheckBox meanTempTimeCheckbox;
    private javax.swing.JCheckBox minTempCheckbox;
    private javax.swing.JLabel minTempLabel;
    private javax.swing.JTextField orbitalEccentricityField;
    private javax.swing.JLabel orbitalEccentricityLabel;
    private javax.swing.JLabel regionMeanTempLabel;
    private javax.swing.JButton runQuery;
    private javax.swing.JButton filter;
    private javax.swing.JButton reset;
    private javax.swing.JButton animate;
    private javax.swing.JTextField simulationEndField;
    private javax.swing.JTextField simulationNameField;
    private javax.swing.JLabel simulationNameLabel;
    private javax.swing.JLabel simulationPeriodLabel;
    private javax.swing.JTextField simulationStartField;
    private javax.swing.JLabel tableOptionsLabel;
    private javax.swing.JLabel tempTimeRegionLabel;
    private javax.swing.JCheckBox tempsTimeRegionCheckbox;
    private javax.swing.JLabel timeMeanTempLabel;
    private ButtonGroup qrybuttonGroup1;
    private JRadioButton byNameButton;
    private JRadioButton byPFButton;
    private ButtonGroup regionbuttonGroup;
    private JRadioButton earthButton;
    private JRadioButton parametersButton;
    private JSpinner nameSpinner;
    private JTable outputTable;
    private JLabel spacer, latStart, latEnd, longStart, longEnd;
    
    // End of variables declaration//GEN-END:variables
    
           
}

/*class SimulationNameSpinnerModel extends SpinnerListModel {
	
	private static final long serialVersionUID = 1346347586797802333L;
    Object firstValue, lastValue;
    SpinnerModel simModel = null;
    List<String> names = null;

    public SimulationNameSpinnerModel(Object[] values) {
        super(values);
        firstValue = values[0];
        lastValue = values[values.length - 1];
    }
    public void setList(List<String> list)
    {
    	names = list;
    }

    public void setModel(SpinnerModel model) {
        this.simModel = model;
    }

    /*public Object getNextValue() {
        Object value = super.getNextValue();
        if (value == null) {
            value = firstValue;
            if (linkedModel != null) {
                linkedModel.setValue(linkedModel.getNextValue());
            }
        }
        return value;
    }

    public Object getPreviousValue() {
        Object value = super.getPreviousValue();
        if (value == null) {
            value = lastValue;
            if (linkedModel != null) {
                linkedModel.setValue(linkedModel.getPreviousValue());
            }
        }
        return value;
    }*/
//}
